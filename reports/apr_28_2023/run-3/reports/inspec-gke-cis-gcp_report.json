{
    "platform": {
        "name": "gcp",
        "release": "google-api-client-v0.52.0",
        "target_id": "7505d64a-54e0-51b7-acd5-4ccd58b49dc4"
    },
    "profiles": [
        {
            "name": "inspec-gke-cis-gcp",
            "version": "0.1.0",
            "sha256": "8b8923dd7bfabc6a97e7effde17e5f6116036c2aeb2e18ff3a63b356c87c3f8f",
            "title": "InSpec GKE CIS 1.1 Benchmark",
            "summary": "Inspec Google Kubernetes Engine Center for Internet Security Benchmark v1.1 Profile",
            "license": "Apache-2.0",
            "copyright": "Google",
            "copyright_email": "copyright@google.com",
            "supports": [
                {
                    "platform": "gcp"
                }
            ],
            "attributes": [
                {
                    "name": "gcp_project_id",
                    "options": {
                        "type": "String",
                        "value": "tigera-tesla"
                    }
                },
                {
                    "name": "cis_version",
                    "options": {
                        "type": "String",
                        "value": "1.1"
                    }
                },
                {
                    "name": "cis_url",
                    "options": {
                        "type": "String",
                        "value": "https://www.cisecurity.org/benchmark/kubernetes/"
                    }
                },
                {
                    "name": "gcp_gke_locations",
                    "options": {
                        "type": "Array",
                        "value": [
                            "us-central1"
                        ]
                    }
                },
                {
                    "name": "gce_zones",
                    "options": {
                        "type": "Array",
                        "value": [
                            "us-central1"
                        ]
                    }
                },
                {
                    "name": "registry_storage_admin_list",
                    "options": {
                        "type": "Array",
                        "value": [
                            "projectEditor:tigera-tesla",
                            "projectOwner:tigera-tesla"
                        ]
                    }
                },
                {
                    "name": "registry_storage_object_admin_list",
                    "options": {
                        "type": "Array",
                        "value": [
                            "serviceAccount:registry-write@tigera-tesla.iam.gserviceaccount.com",
                            "serviceAccount:registry-writer@tigera-tesla.iam.gserviceaccount.com"
                        ]
                    }
                },
                {
                    "name": "registry_storage_object_creator_list",
                    "options": {
                        "type": "Array",
                        "value": [
                            "serviceAccount:registry-write@tigera-tesla.iam.gserviceaccount.com",
                            "serviceAccount:registry-writer@tigera-tesla.iam.gserviceaccount.com"
                        ]
                    }
                },
                {
                    "name": "registry_storage_legacy_bucket_owner_list",
                    "options": {
                        "type": "Array",
                        "value": [
                            ""
                        ]
                    }
                },
                {
                    "name": "registry_storage_legacy_bucket_writer_list",
                    "options": {
                        "type": "Array",
                        "value": [
                            ""
                        ]
                    }
                },
                {
                    "name": "registry_storage_legacy_object_owner_list",
                    "options": {
                        "type": "Array",
                        "value": [
                            ""
                        ]
                    }
                }
            ],
            "depends": [
                {
                    "name": "inspec-gcp-helpers",
                    "url": "https://github.com/GoogleCloudPlatform/inspec-gcp-helpers/archive/1.0.9.tar.gz",
                    "status": "loaded"
                }
            ],
            "groups": [
                {
                    "id": "controls/5.04-node-metadata.rb",
                    "controls": [
                        "cis-gke-5.4.1-node-metadata",
                        "cis-gke-5.4.2-node-metadata"
                    ],
                    "title": "Node Metadata"
                },
                {
                    "id": "controls/5.10-other.rb",
                    "controls": [
                        "cis-gke-5.10.1-other",
                        "cis-gke-5.10.2-other",
                        "cis-gke-5.10.3-other",
                        "cis-gke-5.10.5-other"
                    ],
                    "title": "Other Cluster Configurations"
                },
                {
                    "id": "controls/5.07-logging.rb",
                    "controls": [
                        "cis-gke-5.7.1-logging"
                    ],
                    "title": "Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled"
                },
                {
                    "id": "controls/5.06-networking.rb",
                    "controls": [
                        "cis-gke-5.6-networking",
                        "cis-gke-5.6.3-networking",
                        "cis-gke-5.6.4-networking",
                        "cis-gke-5.6.5-networking",
                        "cis-gke-5.6.7-networking"
                    ],
                    "title": "Cluster Networking"
                },
                {
                    "id": "controls/5.08-authn-authz.rb",
                    "controls": [
                        "cis-gke-5.8.1-authn-authz",
                        "cis-gke-5.8.2-authn-authz",
                        "cis-gke-5.8.4-authn-authz"
                    ],
                    "title": "Authentication and Authorization"
                },
                {
                    "id": "controls/5.02-iam.rb",
                    "controls": [
                        "cis-gke-5.2.1-iam"
                    ],
                    "title": "Ensure GKE clusters are not running using the Compute Engine default service account"
                },
                {
                    "id": "controls/5.03-kms.rb",
                    "controls": [
                        "cis-gke-5.3-networking"
                    ],
                    "title": "Cloud Key Management Service"
                },
                {
                    "id": "controls/5.01-container-registry.rb",
                    "controls": [
                        "cis-gke-5.1.1-container-registry",
                        "cis-gke-5.1.2-container-registry",
                        "cis-gke-5.1.3-container-registry",
                        "cis-gke-5.1.4-container-registry"
                    ],
                    "title": "Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider"
                },
                {
                    "id": "controls/5.05-nodes.rb",
                    "controls": [
                        "cis-gke-5.5.1-nodes",
                        "cis-gke-5.5.2-nodes",
                        "cis-gke-5.5.3-nodes",
                        "cis-gke-5.5.4-nodes",
                        "cis-gke-5.5.5-nodes",
                        "cis-gke-5.5.6-nodes",
                        "cis-gke-5.5.7-nodes"
                    ],
                    "title": "Node Configuration and Maintenance"
                }
            ],
            "controls": [
                {
                    "id": "cis-gke-5.1.1-container-registry",
                    "title": "[CONTAINER-REGISTRY] Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider",
                    "desc": "Scan images stored in Google Container Registry (GCR) for vulnerabilities.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Scan images stored in Google Container Registry (GCR) for vulnerabilities."
                        },
                        {
                            "label": "rationale",
                            "data": "Vulnerabilities in software packages can be exploited by hackers or malicious users to\n  obtain unauthorized access to local cloud resources. GCR Container Analysis and other\n  third party products allow images stored in GCR to be scanned for known vulnerabilities."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/container-registry/docs/container-analysis",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.1.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n  impact 'none'\n\n  title \"[#{control_abbrev.upcase}] Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider\"\n\n  desc 'Scan images stored in Google Container Registry (GCR) for vulnerabilities.'\n  desc 'rationale', \"Vulnerabilities in software packages can be exploited by hackers or malicious users to\n  obtain unauthorized access to local cloud resources. GCR Container Analysis and other\n  third party products allow images stored in GCR to be scanned for known vulnerabilities.\"\n\n  tag cis_scored: true\n  tag cis_level: 1\n  tag cis_gke: sub_control_id.to_s\n  tag cis_version: cis_version.to_s\n  tag project: gcp_project_id.to_s\n\n  ref 'CIS Benchmark', url: cis_url.to_s\n  ref 'GCP Docs', url: 'https://cloud.google.com/container-registry/docs/container-analysis'\n\n  if google_project_service(project: gcp_project_id, name: 'containerregistry.googleapis.com').state == 'DISABLED'\n    impact 'none'\n    describe \"[#{gcp_project_id}] This project does not have the Google Container Registry Service enabled, this test is Not Applicable.\" do\n      skip \"[#{gcp_project_id}] This project does not have the Google Container Registry Service enabled.\"\n    end\n  else\n    describe \"[#{gcp_project_id}]\" do\n      subject { google_project_service(project: gcp_project_id, name: 'containerscanning.googleapis.com') }\n      its('state') { should cmp 'ENABLED' }\n    end\n  end\nend\n",
                    "source_location": {
                        "line": 35,
                        "ref": "inspec-gke-cis-gcp/controls/5.01-container-registry.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] state is expected to cmp == \"ENABLED\"",
                            "run_time": 0.240133837,
                            "start_time": "2023-04-28T16:23:33+00:00",
                            "message": "\nexpected: ENABLED\n     got: DISABLED\n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "state"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.1.2-container-registry",
                    "title": "[CONTAINER-REGISTRY] Minimize user access to GCR",
                    "desc": "Restrict user access to GCR, limiting interaction with build images to only authorized\n  personnel and service accounts.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Restrict user access to GCR, limiting interaction with build images to only authorized\n  personnel and service accounts."
                        },
                        {
                            "label": "rationale",
                            "data": "Weak access control to GCR may allow malicious users to replace built images with\n  vulnerable or backdoored containers."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/container-registry/docs/access-control",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.1.2",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n  impact 'medium'\n\n  title \"[#{control_abbrev.upcase}] Minimize user access to GCR\"\n\n  desc 'Restrict user access to GCR, limiting interaction with build images to only authorized\n  personnel and service accounts.'\n  desc 'rationale', \"Weak access control to GCR may allow malicious users to replace built images with\n  vulnerable or backdoored containers.\"\n\n  tag cis_scored: false\n  tag cis_level: 1\n  tag cis_gke: sub_control_id.to_s\n  tag cis_version: cis_version.to_s\n  tag project: gcp_project_id.to_s\n\n  ref 'CIS Benchmark', url: cis_url.to_s\n  ref 'GCP Docs', url: 'https://cloud.google.com/container-registry/docs/access-control'\n\n  # Check if storage bucket exists\n  if google_storage_bucket(name: \"artifacts.#{gcp_project_id}.appspot.com\").name.nil?\n    impact 'none'\n    describe \"[#{gcp_project_id}] does not have a storage bucket for Google Container Registry Images, this test is Not Applicable.\" do\n      skip \"[#{gcp_project_id}] does not have a storage bucket for Google Container Registry Images.\"\n    end\n  else\n    bucket_iam_policy = google_storage_bucket_iam_policy(bucket: \"artifacts.#{gcp_project_id}.appspot.com\")\n    bucket_iam_policy.bindings.each do |iam_policy|\n      case iam_policy.role\n      when 'roles/storage.admin'\n        role_member_list = registry_storage_admin_list\n      when 'roles/storage.objectAdmin'\n        role_member_list = registry_storage_object_admin_list\n      when 'roles/storage.objectCreator'\n        role_member_list = registry_storage_object_creator_list\n      when 'roles/storage.legacyBucketOwner'\n        role_member_list = registry_storage_legacy_bucket_owner_list\n      when 'roles/storage.legacyBucketWriter'\n        role_member_list = registry_storage_legacy_bucket_writer_list\n      when 'roles/storage.legacyObjectOwner'\n        role_member_list = registry_storage_legacy_object_owner_list\n      else\n        next\n      end\n      describe \"[#{gcp_project_id}] Members for #{iam_policy.role} in Storage Bucket artifacts.#{gcp_project_id}.appspot.com\" do\n        subject { google_storage_bucket_iam_binding(bucket: \"artifacts.#{gcp_project_id}.appspot.com\", role: iam_policy.role) }\n        it 'match the allow list' do\n          expect(subject.members).to cmp(role_member_list)\n        end\n      end\n    end\n  end\nend\n",
                    "source_location": {
                        "line": 69,
                        "ref": "inspec-gke-cis-gcp/controls/5.01-container-registry.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Members for roles/storage.admin in Storage Bucket artifacts.tigera-tesla.appspot.com match the allow list",
                            "run_time": 0.175812528,
                            "start_time": "2023-04-28T16:23:33+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "[tigera-tesla] Members for roles/storage.admin in Storage Bucket artifacts.tigera-tesla.appspot.com"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.1.3-container-registry",
                    "title": "[CONTAINER-REGISTRY] Minimize cluster access to read-only for GCR",
                    "desc": "Configure the Cluster Service Account with Storage Object Viewer Role to only allow read-only access to GCR.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Configure the Cluster Service Account with Storage Object Viewer Role to only allow read-only access to GCR."
                        },
                        {
                            "label": "rationale",
                            "data": "The Cluster Service Account does not require administrative access to GCR, only requiring\n  pull access to containers to deploy onto GKE. Restricting permissions follows the principles\n  of least privilege and prevents credentials from being abused beyond the required role."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/container-registry/docs/container-analysis",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.1.3",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n  impact 'none'\n\n  title \"[#{control_abbrev.upcase}] Minimize cluster access to read-only for GCR\"\n\n  desc 'Configure the Cluster Service Account with Storage Object Viewer Role to only allow read-only access to GCR.'\n  desc 'rationale', \"The Cluster Service Account does not require administrative access to GCR, only requiring\n  pull access to containers to deploy onto GKE. Restricting permissions follows the principles\n  of least privilege and prevents credentials from being abused beyond the required role.\"\n\n  tag cis_scored: false\n  tag cis_level: 1\n  tag cis_gke: sub_control_id.to_s\n  tag cis_version: cis_version.to_s\n  tag project: gcp_project_id.to_s\n\n  ref 'CIS Benchmark', url: cis_url.to_s\n  ref 'GCP Docs', url: 'https://cloud.google.com/container-registry/docs/container-analysis'\n\n  if gke_clusters.nil? || gke_clusters.count.zero?\n    impact 'none'\n    describe \"[#{gcp_project_id}] does not have any GKE clusters, this test is Not Applicable.\" do\n      skip \"[#{gcp_project_id}] does not have any GKE clusters.\"\n    end\n  elsif google_storage_bucket(name: \"artifacts.#{gcp_project_id}.appspot.com\").name.nil?\n    impact 'none'\n    describe \"[#{gcp_project_id}] does not have a storage bucket for Google Container Registry Images, this test is Not Applicable.\" do\n      skip \"[#{gcp_project_id}] does not have a storage bucket for Google Container Registry Images.\"\n    end\n  else\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        nodepool_sa = google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname).config.service_account\n\n        # 1st check: Make sure that nodepool service account does not have any role other than storage.objectViewer assigned\n        google_storage_bucket_iam_bindings(bucket: \"artifacts.#{gcp_project_id}.appspot.com\").iam_binding_roles.each do |iam_binding_role|\n          next if iam_binding_role == 'roles/storage.objectViewer'\n          describe \"[#{gcp_project_id}] IAM Binding of role #{iam_binding_role} on Storage Bucket artifacts.#{gcp_project_id}.appspot.com\" do\n            subject { google_storage_bucket_iam_binding(bucket: \"artifacts.#{gcp_project_id}.appspot.com\", role: iam_binding_role) }\n            its('members') { should_not include \"serviceAccount:#{nodepool_sa}\" }\n          end\n        end\n\n        # 2nd check: Make sure that nodepool service account has role storage.objectViewer assigned\n        iam_binding_object_viewer = google_storage_bucket_iam_binding(bucket: \"artifacts.#{gcp_project_id}.appspot.com\", role: 'roles/storage.objectViewer')\n        describe \"[#{gcp_project_id}] IAM Binding of role roles/storage.objectViewer on Storage Bucket artifacts.#{gcp_project_id}.appspot.com\" do\n          subject { iam_binding_object_viewer }\n          it { should exist }\n        end\n        next if iam_binding_object_viewer.members.nil?\n        describe \"[#{gcp_project_id}] IAM Binding of role roles/storage.objectViewer on Storage Bucket artifacts.#{gcp_project_id}.appspot.com\" do\n          subject { iam_binding_object_viewer }\n          its('members') { should include \"serviceAccount:#{nodepool_sa}\" }\n        end\n      end\n    end\n  end\nend\n",
                    "source_location": {
                        "line": 125,
                        "ref": "inspec-gke-cis-gcp/controls/5.01-container-registry.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] IAM Binding of role roles/storage.admin on Storage Bucket artifacts.tigera-tesla.appspot.com members is expected not to include \"serviceAccount:operations@tigera-tesla.iam.gserviceaccount.com\"",
                            "run_time": 0.198923036,
                            "start_time": "2023-04-28T16:23:33+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "members"
                        },
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] IAM Binding of role roles/storage.legacyBucketReader on Storage Bucket artifacts.tigera-tesla.appspot.com members is expected not to include \"serviceAccount:operations@tigera-tesla.iam.gserviceaccount.com\"",
                            "run_time": 0.199947899,
                            "start_time": "2023-04-28T16:23:34+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "members"
                        },
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] IAM Binding of role roles/storage.objectViewer on Storage Bucket artifacts.tigera-tesla.appspot.com is expected to exist",
                            "run_time": 0.002530023,
                            "start_time": "2023-04-28T16:23:34+00:00",
                            "message": "expected Bucket IamBinding artifacts.tigera-tesla.appspot.com Role: roles/storage.objectViewer to exist",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "[tigera-tesla] IAM Binding of role roles/storage.objectViewer on Storage Bucket artifacts.tigera-tesla.appspot.com"
                        },
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] IAM Binding of role roles/storage.admin on Storage Bucket artifacts.tigera-tesla.appspot.com members is expected not to include \"serviceAccount:default\"",
                            "run_time": 0.19129788,
                            "start_time": "2023-04-28T16:23:34+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "members"
                        },
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] IAM Binding of role roles/storage.legacyBucketReader on Storage Bucket artifacts.tigera-tesla.appspot.com members is expected not to include \"serviceAccount:default\"",
                            "run_time": 0.198211434,
                            "start_time": "2023-04-28T16:23:34+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "members"
                        },
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] IAM Binding of role roles/storage.objectViewer on Storage Bucket artifacts.tigera-tesla.appspot.com is expected to exist",
                            "run_time": 0.000483246,
                            "start_time": "2023-04-28T16:23:34+00:00",
                            "message": "expected Bucket IamBinding artifacts.tigera-tesla.appspot.com Role: roles/storage.objectViewer to exist",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "[tigera-tesla] IAM Binding of role roles/storage.objectViewer on Storage Bucket artifacts.tigera-tesla.appspot.com"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.1.4-container-registry",
                    "title": "[CONTAINER-REGISTRY] Minimize Container Registries to only those approved",
                    "desc": "Use Binary Authorization to allowlist only approved container registries.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Use Binary Authorization to allowlist only approved container registries."
                        },
                        {
                            "label": "rationale",
                            "data": "Allowing unrestricted access to external container registries provides the opportunity for\n  malicious or unapproved containers to be deployed into the cluster. Allowlisting only\n  approved container registries reduces this risk.\n  See also Recommendation 6.10.5."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/binary-authorization/",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 2,
                        "cis_gke": "5.1.4",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n  impact 'medium'\n\n  title \"[#{control_abbrev.upcase}] Minimize Container Registries to only those approved\"\n\n  desc 'Use Binary Authorization to allowlist only approved container registries.'\n  desc 'rationale', \"Allowing unrestricted access to external container registries provides the opportunity for\n  malicious or unapproved containers to be deployed into the cluster. Allowlisting only\n  approved container registries reduces this risk.\n  See also Recommendation 6.10.5.\"\n\n  tag cis_scored: false\n  tag cis_level: 2\n  tag cis_gke: sub_control_id.to_s\n  tag cis_version: cis_version.to_s\n  tag project: gcp_project_id.to_s\n\n  ref 'CIS Benchmark', url: cis_url.to_s\n  ref 'GCP Docs', url: 'https://cloud.google.com/binary-authorization/'\n\n  gke_clusters.each do |gke_cluster|\n    describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n      subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n      its('binary_authorization.enabled') { should cmp true }\n      # TODO: Implement check for \"Allow all policy\" (currently no method available with inspec-gcp)\n    end\n  end\nend\n",
                    "source_location": {
                        "line": 186,
                        "ref": "inspec-gke-cis-gcp/controls/5.01-container-registry.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 binary_authorization.enabled is expected to cmp == true",
                            "run_time": 0.216768194,
                            "start_time": "2023-04-28T16:23:34+00:00",
                            "message": "\nexpected: true\n     got: true\n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "binary_authorization.enabled"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.2.1-iam",
                    "title": "[IAM] Ensure GKE clusters are not running using the Compute Engine default service account",
                    "desc": "Create and use minimally privileged Service accounts to run GKE cluster nodes instead of using the Compute Engine default Service account. Unnecessary permissions could be abused in the case of a node compromise.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Create and use minimally privileged Service accounts to run GKE cluster nodes instead of using the Compute Engine default Service account. Unnecessary permissions could be abused in the case of a node compromise."
                        },
                        {
                            "label": "rationale",
                            "data": "A GCP service account (as distinct from a Kubernetes ServiceAccount) is an identity that an instance or an application can use to run GCP API requests on your behalf. This identity is used to identify virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes use the Compute Engine default service account. This account has broad access by default, as defined by access scopes, making it useful to a wide variety of applications on the VM, but it has more permissions than are required to run your Kubernetes Engine cluster.\n\nYou should create and use a minimally privileged service account to run your Kubernetes Engine cluster instead of using the Compute Engine default service account, and create separate service accounts for each Kubernetes Workload (See Recommendation 6.2.2).\n\nKubernetes Engine requires, at a minimum, the node service account to have the monitoring.viewer, monitoring.metricWriter, and logging.logWriter roles. Additional roles may need to be added for the nodes to pull images from GCR."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/compute/docs/access/service-accounts#compute_engine_default_service_account",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.2.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "control \"cis-gke-#{control_id}-#{control_abbrev}\" do\n  impact 'medium'\n\n  title \"[#{control_abbrev.upcase}] Ensure GKE clusters are not running using the Compute Engine default service account\"\n\n  desc 'Create and use minimally privileged Service accounts to run GKE cluster nodes instead of using the Compute Engine default Service account. Unnecessary permissions could be abused in the case of a node compromise.'\n  desc 'rationale', \"A GCP service account (as distinct from a Kubernetes ServiceAccount) is an identity that an instance or an application can use to run GCP API requests on your behalf. This identity is used to identify virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes use the Compute Engine default service account. This account has broad access by default, as defined by access scopes, making it useful to a wide variety of applications on the VM, but it has more permissions than are required to run your Kubernetes Engine cluster.\n\nYou should create and use a minimally privileged service account to run your Kubernetes Engine cluster instead of using the Compute Engine default service account, and create separate service accounts for each Kubernetes Workload (See Recommendation 6.2.2).\n\nKubernetes Engine requires, at a minimum, the node service account to have the monitoring.viewer, monitoring.metricWriter, and logging.logWriter roles. Additional roles may need to be added for the nodes to pull images from GCR.\"\n\n  tag cis_scored: true\n  tag cis_level: 1\n  tag cis_gke: control_id.to_s\n  tag cis_version: cis_version.to_s\n  tag project: gcp_project_id.to_s\n\n  ref 'CIS Benchmark', url: cis_url.to_s\n  ref 'GCP Docs', url: 'https://cloud.google.com/compute/docs/access/service-accounts#compute_engine_default_service_account'\n\n  if gke_clusters.nil? || gke_clusters.count.zero?\n    impact 'none'\n    describe \"[#{gcp_project_id}] does not have any GKE clusters, this test is Not Applicable.\" do\n      skip \"[#{gcp_project_id}] does not have any GKE clusters.\"\n    end\n  else\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}/#{nodepoolname}\" do\n          subject { google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname) }\n          its('config.service_account') { should_not cmp 'default' }\n        end\n      end\n    end\n  end\nend\n",
                    "source_location": {
                        "line": 26,
                        "ref": "inspec-gke-cis-gcp/controls/5.02-iam.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01/pool-2 config.service_account is expected not to cmp == \"default\"",
                            "run_time": 0.231603777,
                            "start_time": "2023-04-28T16:23:31+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "config.service_account"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.3-networking",
                    "title": "[NETWORKING] Ensure Kubernetes Secrets are encrypted using keys managed in\n    Cloud KMS",
                    "desc": "Encrypt Kubernetes secrets, stored in etcd, at the application-layer using a customer-\n    managed key in Cloud KMS.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Encrypt Kubernetes secrets, stored in etcd, at the application-layer using a customer-\n    managed key in Cloud KMS."
                        },
                        {
                            "label": "rationale",
                            "data": "Tigera Response: Not applicable, PSP is depreciated in Kubernetes v1.25 which we will upgrade to in Q2.\n Default: By default, GKE encrypts customer content stored at rest, including Secrets. GKE handles\n    and manages this default encryption for you without any additional action on your part.\n    Application-layer Secrets Encryption provides an additional layer of security for sensitive\n    data, such as user defined Secrets and Secrets required for the operation of the cluster,\n    such as service account keys, which are all stored in etcd.\n    Using this functionality, you can use a key, that you manage in Cloud KMS, to encrypt data\n    at the application layer. This protects against attackers in the event that they manage to\n    gain access to etcd."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.3.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Kubernetes Secrets are encrypted using keys managed in\n    Cloud KMS\"\n\n    desc \"Encrypt Kubernetes secrets, stored in etcd, at the application-layer using a customer-\n    managed key in Cloud KMS.\"\n    desc 'rationale', \"By default, GKE encrypts customer content stored at rest, including Secrets. GKE handles\n    and manages this default encryption for you without any additional action on your part.\n    Application-layer Secrets Encryption provides an additional layer of security for sensitive\n    data, such as user defined Secrets and Secrets required for the operation of the cluster,\n    such as service account keys, which are all stored in etcd.\n    Using this functionality, you can use a key, that you manage in Cloud KMS, to encrypt data\n    at the application layer. This protects against attackers in the event that they manage to\n    gain access to etcd.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('database_encryption.key_name') { should_not eq nil }\n        its('database_encryption.state') { should cmp 'ENCRYPTED' }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 38,
                        "ref": "inspec-gke-cis-gcp/controls/5.03-kms.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 database_encryption.key_name is expected not to eq nil",
                            "run_time": 0.273687561,
                            "start_time": "2023-04-28T16:23:32+00:00",
                            "message": "\nexpected: value != nil\n     got: nil\n\n(compared using ==)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "database_encryption.key_name"
                        },
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 database_encryption.state is expected to cmp == \"ENCRYPTED\"",
                            "run_time": 0.254972555,
                            "start_time": "2023-04-28T16:23:32+00:00",
                            "message": "\nexpected: ENCRYPTED\n     got: DECRYPTED\n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "database_encryption.state"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.4.1-node-metadata",
                    "title": "[NODE-METADATA] Ensure legacy Compute Engine instance metadata APIs are Disabled",
                    "desc": "Disable the legacy GCE instance metadata APIs for GKE nodes. Under some circumstances, these can be used from within a pod to extract the node's credentials.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Disable the legacy GCE instance metadata APIs for GKE nodes. Under some circumstances, these can be used from within a pod to extract the node's credentials."
                        },
                        {
                            "label": "rationale",
                            "data": "The legacy GCE metadata endpoint allows simple HTTP requests to be made returning\n    sensitive information. To prevent the enumeration of metadata endpoints and data\n    exfiltration, the legacy metadata endpoint must be disabled.\n\n    Without requiring a custom HTTP header when accessing the legacy GCE metadata\n    endpoint, a flaw in an application that allows an attacker to trick the code into retrieving\n    the contents of an attacker-specified web URL could provide a simple method for\n    enumeration and potential credential exfiltration. By requiring a custom HTTP header, the\n    attacker needs to exploit an application flaw that allows them to control the URL and also\n    add custom headers in order to carry out this attack successfully."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#disable-legacy-apis",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.4.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure legacy Compute Engine instance metadata APIs are Disabled\"\n\n    desc \"Disable the legacy GCE instance metadata APIs for GKE nodes. Under some circumstances, these can be used from within a pod to extract the node's credentials.\"\n    desc 'rationale', \"The legacy GCE metadata endpoint allows simple HTTP requests to be made returning\n    sensitive information. To prevent the enumeration of metadata endpoints and data\n    exfiltration, the legacy metadata endpoint must be disabled.\n\n    Without requiring a custom HTTP header when accessing the legacy GCE metadata\n    endpoint, a flaw in an application that allows an attacker to trick the code into retrieving\n    the contents of an attacker-specified web URL could provide a simple method for\n    enumeration and potential credential exfiltration. By requiring a custom HTTP header, the\n    attacker needs to exploit an application flaw that allows them to control the URL and also\n    add custom headers in order to carry out this attack successfully.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#disable-legacy-apis'\n\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        nodepool = google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname)\n        has_legacy_endpoints_disabled = nodepool.config.metadata['disable-legacy-endpoints']\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}, Node Pool: #{nodepoolname}\" do\n          subject { nodepool }\n          it 'should have legacy endpoints disabled.' do\n            expect(has_legacy_endpoints_disabled).to cmp 'true'\n          end\n        end\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 38,
                        "ref": "inspec-gke-cis-gcp/controls/5.04-node-metadata.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2 should have legacy endpoints disabled.",
                            "run_time": 0.000323839,
                            "start_time": "2023-04-28T16:23:21+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.4.2-node-metadata",
                    "title": "[NODE-METADATA] Ensure the GKE Metadata Server is Enabled",
                    "desc": "Running the GKE Metadata Server prevents workloads from accessing sensitive instance\n    metadata and facilitates Workload Identity",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Running the GKE Metadata Server prevents workloads from accessing sensitive instance\n    metadata and facilitates Workload Identity."
                        },
                        {
                            "label": "rationale",
                            "data": "Tigera Response: Not applicable, we segregate workloads to different node pools. Using workload identity\n  is not needed since we use metadata server for the workloads per node pool.\n Default: Every node stores its metadata on a metadata server. Some of this metadata, such as\n    kubelet credentials and the VM instance identity token, is sensitive and should not be\n    exposed to a Kubernetes workload. Enabling the GKE Metadata server prevents pods (that\n    are not running on the host network) from accessing this metadata and facilitates\n    Workload Identity.\n    When unspecified, the default setting allows running pods to have full access to the node's\n    underlying metadata server."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#concealment",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 2,
                        "cis_gke": "5.4.2",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure the GKE Metadata Server is Enabled\"\n\n    desc \"Running the GKE Metadata Server prevents workloads from accessing sensitive instance\n    metadata and facilitates Workload Identity\"\n    desc 'rationale', \"Every node stores its metadata on a metadata server. Some of this metadata, such as\n    kubelet credentials and the VM instance identity token, is sensitive and should not be\n    exposed to a Kubernetes workload. Enabling the GKE Metadata server prevents pods (that\n    are not running on the host network) from accessing this metadata and facilitates\n    Workload Identity.\n    When unspecified, the default setting allows running pods to have full access to the node's\n    underlying metadata server.\"\n\n    tag cis_scored: true\n    tag cis_level: 2\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#concealment'\n\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}, Node Pool: #{nodepoolname}\" do\n          subject { google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname) }\n          its('config.workload_meta_config.mode') { should be_in %w[GCE_METADATA GKE_METADATA] }\n        end\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 80,
                        "ref": "inspec-gke-cis-gcp/controls/5.04-node-metadata.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2 config.workload_meta_config.mode is expected to be in \"GCE_METADATA\" and \"GKE_METADATA\"",
                            "run_time": 0.26312759,
                            "start_time": "2023-04-28T16:23:21+00:00",
                            "message": "expected `` to be in the list: `[\"GCE_METADATA\", \"GKE_METADATA\"]`",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "config.workload_meta_config.mode"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.5.1-nodes",
                    "title": "[NODES] Ensure Container-Optimized OS (COS) is used for GKE node images",
                    "desc": "Use Container-Optimized OS (COS) as a managed, optimized and hardened base OS that limits the host's attack surface.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Use Container-Optimized OS (COS) as a managed, optimized and hardened base OS that limits the host's attack surface."
                        },
                        {
                            "label": "rationale",
                            "data": "COS is an operating system image for Compute Engine VMs optimized for running containers. With COS, you can bring up your containers on Google Cloud Platform quickly, efficiently, and securely.\n\n  Using COS as the node image provides the following benefits:\n\n  - Run containers out of the box: COS instances come pre-installed with the container runtime and cloud-init. With a COS instance, you can bring up your container at the same time you create your VM, with no on-host setup required.\n  - Smaller attack surface: COS has a smaller footprint, reducing your instance's potential attack surface.\n  - Locked-down by default: COS instances include a locked-down firewall and other security settings by default."
                        }
                    ],
                    "impact": 0.1,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/node-images",
                            "ref": "GCP Docs"
                        },
                        {
                            "url": "https://cloud.google.com/container-optimized-os/docs/",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 2,
                        "cis_gke": "5.5.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'low'\n\n    title \"[#{control_abbrev.upcase}] Ensure Container-Optimized OS (COS) is used for GKE node images\"\n\n    desc \"Use Container-Optimized OS (COS) as a managed, optimized and hardened base OS that limits the host's attack surface.\"\n    desc 'rationale', \"COS is an operating system image for Compute Engine VMs optimized for running containers. With COS, you can bring up your containers on Google Cloud Platform quickly, efficiently, and securely.\n\n  Using COS as the node image provides the following benefits:\n\n  - Run containers out of the box: COS instances come pre-installed with the container runtime and cloud-init. With a COS instance, you can bring up your container at the same time you create your VM, with no on-host setup required.\n  - Smaller attack surface: COS has a smaller footprint, reducing your instance's potential attack surface.\n  - Locked-down by default: COS instances include a locked-down firewall and other security settings by default.\"\n\n    tag cis_scored: true\n    tag cis_level: 2\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/concepts/node-images'\n    ref 'GCP Docs', url: 'https://cloud.google.com/container-optimized-os/docs/'\n\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}, Node Pool: #{nodepoolname}\" do\n          subject { google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname) }\n          its('config.image_type') { should match(/COS/) }\n        end\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 38,
                        "ref": "inspec-gke-cis-gcp/controls/5.05-nodes.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2 config.image_type is expected to match /COS/",
                            "run_time": 0.227962511,
                            "start_time": "2023-04-28T16:23:35+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "config.image_type"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.5.2-nodes",
                    "title": "[NODES] Ensure Node Auto-Repair is enabled for GKE nodes",
                    "desc": "Nodes in a degraded state are an unknown quantity and so may pose a security risk.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Nodes in a degraded state are an unknown quantity and so may pose a security risk."
                        },
                        {
                            "label": "rationale",
                            "data": "Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-repair",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.5.2",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Node Auto-Repair is enabled for GKE nodes\"\n\n    desc 'Nodes in a degraded state are an unknown quantity and so may pose a security risk.'\n    desc 'rationale', \"Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-repair'\n\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}, Node Pool: #{nodepoolname}\" do\n          subject { google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname) }\n          its('management.auto_repair') { should cmp true }\n        end\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 74,
                        "ref": "inspec-gke-cis-gcp/controls/5.05-nodes.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2 management.auto_repair is expected to cmp == true",
                            "run_time": 0.240058973,
                            "start_time": "2023-04-28T16:23:35+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "management.auto_repair"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.5.3-nodes",
                    "title": "[NODES] Ensure Node Auto-Upgrade is enabled for GKE nodes",
                    "desc": "Node auto-upgrade keeps nodes at the current Kubernetes and OS security patch level to mitigate known vulnerabilities.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Node auto-upgrade keeps nodes at the current Kubernetes and OS security patch level to mitigate known vulnerabilities."
                        },
                        {
                            "label": "rationale",
                            "data": "Node auto-upgrade helps you keep the nodes in your cluster or Node pool up to date with the latest stable patch version of Kubernetes as well as the underlying node operating system. Node auto-upgrade uses the same update mechanism as manual node upgrades.\n\n  Node pools with node auto-upgrade enabled are automatically scheduled for upgrades when a new stable Kubernetes version becomes available. When the upgrade is performed, the Node pool is upgraded to match the current cluster master version. From a security perspective, this has the benefit of applying security updates automatically to the Kubernetes Engine when security fixes are released."
                        }
                    ],
                    "impact": 0.1,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.5.3",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'low'\n\n    title \"[#{control_abbrev.upcase}] Ensure Node Auto-Upgrade is enabled for GKE nodes\"\n\n    desc 'Node auto-upgrade keeps nodes at the current Kubernetes and OS security patch level to mitigate known vulnerabilities.'\n    desc 'rationale', \"Node auto-upgrade helps you keep the nodes in your cluster or Node pool up to date with the latest stable patch version of Kubernetes as well as the underlying node operating system. Node auto-upgrade uses the same update mechanism as manual node upgrades.\n\n  Node pools with node auto-upgrade enabled are automatically scheduled for upgrades when a new stable Kubernetes version becomes available. When the upgrade is performed, the Node pool is upgraded to match the current cluster master version. From a security perspective, this has the benefit of applying security updates automatically to the Kubernetes Engine when security fixes are released.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades'\n\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}, Node Pool: #{nodepoolname}\" do\n          subject { google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname) }\n          its('management.auto_upgrade') { should cmp true }\n        end\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 103,
                        "ref": "inspec-gke-cis-gcp/controls/5.05-nodes.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2 management.auto_upgrade is expected to cmp == true",
                            "run_time": 0.233655539,
                            "start_time": "2023-04-28T16:23:37+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "management.auto_upgrade"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.5.4-nodes",
                    "title": "[NODES] When creating New Clusters - Automate GKE version management\n    using Release Channels",
                    "desc": "Subscribe to the Regular or Stable Release Channel to automate version upgrades to the\n    GKE cluster and to reduce version management complexity to the number of features and\n    level of stability required.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Subscribe to the Regular or Stable Release Channel to automate version upgrades to the\n    GKE cluster and to reduce version management complexity to the number of features and\n    level of stability required."
                        },
                        {
                            "label": "rationale",
                            "data": "Tigera Response: Not applicable, we pin to specific K8s versions to keep control of upgrades.\n Default: Release Channels signal a graduating level of stability and production-readiness. These are\n    based on observed performance of GKE clusters running that version and represent\n    experience and confidence in the cluster version.\n    The Regular release channel upgrades every few weeks and is for production users who\n    need features not yet offered in the Stable channel. These versions have passed internal\n    validation, but don't have enough historical data to guarantee their stability. Known issues\n    generally have known workarounds.\n    The Stable release channel upgrades every few months and is for production users who\n    need stability above all else, and for whom frequent upgrades are too risky. These versions\n    have passed internal validation and have been shown to be stable and reliable in\n    production, based on the observed performance of those clusters.\n    Critical security patches are delivered to all release channels."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.5.4",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'low'\n\n    title \"[#{control_abbrev.upcase}] When creating New Clusters - Automate GKE version management\n    using Release Channels\"\n\n    desc 'Subscribe to the Regular or Stable Release Channel to automate version upgrades to the\n    GKE cluster and to reduce version management complexity to the number of features and\n    level of stability required.'\n    desc 'rationale', \"Release Channels signal a graduating level of stability and production-readiness. These are\n    based on observed performance of GKE clusters running that version and represent\n    experience and confidence in the cluster version.\n    The Regular release channel upgrades every few weeks and is for production users who\n    need features not yet offered in the Stable channel. These versions have passed internal\n    validation, but don't have enough historical data to guarantee their stability. Known issues\n    generally have known workarounds.\n    The Stable release channel upgrades every few months and is for production users who\n    need stability above all else, and for whom frequent upgrades are too risky. These versions\n    have passed internal validation and have been shown to be stable and reliable in\n    production, based on the observed performance of those clusters.\n    Critical security patches are delivered to all release channels.\"\n\n    tag cis_scored: false\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('release_channel.channel') { should be_in %w[STABLE REGULAR] }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 134,
                        "ref": "inspec-gke-cis-gcp/controls/5.05-nodes.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 release_channel.channel is expected to be in \"STABLE\" and \"REGULAR\"",
                            "run_time": 0.242405363,
                            "start_time": "2023-04-28T16:23:38+00:00",
                            "message": "expected `` to be in the list: `[\"STABLE\", \"REGULAR\"]`",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "release_channel.channel"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.5.5-nodes",
                    "title": "[NODES] Ensure Shielded GKE Nodes are Enabled",
                    "desc": "Shielded GKE Nodes provides verifiable integrity via secure boot, virtual trusted platform\n    module (vTPM)-enabled measured boot, and integrity monitoring.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Shielded GKE Nodes provides verifiable integrity via secure boot, virtual trusted platform\n    module (vTPM)-enabled measured boot, and integrity monitoring."
                        },
                        {
                            "label": "rationale",
                            "data": "Shielded GKE nodes protects clusters against boot- or kernel-level malware or rootkits\n    which persist beyond infected OS.\n    Shielded GKE nodes run firmware which is signed and verified using Google's Certificate\n    Authority, ensuring that the nodes' firmware is unmodified and establishing the root of\n    trust for Secure Boot. GKE node identity is strongly protected via virtual Trusted Platform\n    Module (vTPM) and verified remotely by the master node before the node joins the cluster.\n    Lastly, GKE node integrity (i.e., boot sequence and kernel) is measured and can be\n    monitored and verified remotely."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.5.5",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Shielded GKE Nodes are Enabled\"\n\n    desc 'Shielded GKE Nodes provides verifiable integrity via secure boot, virtual trusted platform\n    module (vTPM)-enabled measured boot, and integrity monitoring.'\n    desc 'rationale', \"Shielded GKE nodes protects clusters against boot- or kernel-level malware or rootkits\n    which persist beyond infected OS.\n    Shielded GKE nodes run firmware which is signed and verified using Google's Certificate\n    Authority, ensuring that the nodes' firmware is unmodified and establishing the root of\n    trust for Secure Boot. GKE node identity is strongly protected via virtual Trusted Platform\n    Module (vTPM) and verified remotely by the master node before the node joins the cluster.\n    Lastly, GKE node integrity (i.e., boot sequence and kernel) is measured and can be\n    monitored and verified remotely.\"\n\n    tag cis_scored: false\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('shielded_nodes.enabled') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 175,
                        "ref": "inspec-gke-cis-gcp/controls/5.05-nodes.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 shielded_nodes.enabled is expected to cmp == true",
                            "run_time": 0.248551058,
                            "start_time": "2023-04-28T16:23:40+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "shielded_nodes.enabled"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.5.6-nodes",
                    "title": "[NODES] Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled",
                    "desc": "Enable Integrity Monitoring for Shielded GKE Nodes to be notified of inconsistencies during\n    the node boot sequence.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Enable Integrity Monitoring for Shielded GKE Nodes to be notified of inconsistencies during\n    the node boot sequence."
                        },
                        {
                            "label": "rationale",
                            "data": "Integrity Monitoring provides active alerting for Shielded GKE nodes which allows\n    administrators to respond to integrity failures and prevent compromised nodes from being\n    deployed into the cluster."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#system_integrity_monitoring",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.5.6",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled\"\n\n    desc 'Enable Integrity Monitoring for Shielded GKE Nodes to be notified of inconsistencies during\n    the node boot sequence.'\n    desc 'rationale', \"Integrity Monitoring provides active alerting for Shielded GKE nodes which allows\n    administrators to respond to integrity failures and prevent compromised nodes from being\n    deployed into the cluster.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#system_integrity_monitoring'\n\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}, Node Pool: #{nodepoolname}\" do\n          subject { google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname) }\n          its('config.shielded_instance_config.enable_integrity_monitoring') { should cmp true }\n        end\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 210,
                        "ref": "inspec-gke-cis-gcp/controls/5.05-nodes.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2 config.shielded_instance_config.enable_integrity_monitoring is expected to cmp == true",
                            "run_time": 0.232718043,
                            "start_time": "2023-04-28T16:23:41+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "config.shielded_instance_config.enable_integrity_monitoring"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.5.7-nodes",
                    "title": "[NODES] Ensure Secure Boot for Shielded GKE Nodes is Enabled",
                    "desc": "Enable Secure Boot for Shielded GKE Nodes to verify the digital signature of node boot\n    components.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Enable Secure Boot for Shielded GKE Nodes to verify the digital signature of node boot\n    components."
                        },
                        {
                            "label": "rationale",
                            "data": "An attacker may seek to alter boot components to persist malware or root kits during\n    system initialisation. Secure Boot helps ensure that the system only runs authentic\n    software by verifying the digital signature of all boot components, and halting the boot\n    process if signature verification fails."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#secure_boot",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 2,
                        "cis_gke": "5.5.7",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Secure Boot for Shielded GKE Nodes is Enabled\"\n\n    desc 'Enable Secure Boot for Shielded GKE Nodes to verify the digital signature of node boot\n    components.'\n    desc 'rationale', \"An attacker may seek to alter boot components to persist malware or root kits during\n    system initialisation. Secure Boot helps ensure that the system only runs authentic\n    software by verifying the digital signature of all boot components, and halting the boot\n    process if signature verification fails.\"\n\n    tag cis_scored: true\n    tag cis_level: 2\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#secure_boot'\n\n    gke_clusters.each do |gke_cluster|\n      google_container_node_pools(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name]).node_pool_names.each do |nodepoolname|\n        describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}, Node Pool: #{nodepoolname}\" do\n          subject { google_container_node_pool(project: gcp_project_id, location: gke_cluster[:location], cluster_name: gke_cluster[:cluster_name], nodepool_name: nodepoolname) }\n          its('config.shielded_instance_config.enable_secure_boot') { should cmp true }\n        end\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 242,
                        "ref": "inspec-gke-cis-gcp/controls/5.05-nodes.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01, Node Pool: pool-2 config.shielded_instance_config.enable_secure_boot is expected to cmp == true",
                            "run_time": 0.231753165,
                            "start_time": "2023-04-28T16:23:41+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "config.shielded_instance_config.enable_secure_boot"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.6-networking",
                    "title": "[NETWORKING] Ensure use of VPC-native clusters",
                    "desc": "Create Alias IPs for the node network CIDR range in order to subsequently configure IP- based policies and firewalling for pods. A cluster that uses Alias IPs is called a 'VPC-native' cluster.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Create Alias IPs for the node network CIDR range in order to subsequently configure IP- based policies and firewalling for pods. A cluster that uses Alias IPs is called a 'VPC-native' cluster."
                        },
                        {
                            "label": "rationale",
                            "data": "Using Alias IPs has several benefits:\n\n  - Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources.\n  - The networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs.\n  - Firewall controls for Pods can be applied separately from their nodes.\n  - Alias IPs allow Pods to directly access hosted services without using a NAT gateway."
                        }
                    ],
                    "impact": 0.1,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/intranode-visibility",
                            "ref": "GCP Docs"
                        },
                        {
                            "ref": [
                                {
                                    "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                                    "ref": "CIS Benchmark"
                                },
                                {
                                    "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/alias-ips",
                                    "ref": "GCP Docs"
                                },
                                {
                                    "url": "https://cloud.google.com/vpc/docs/alias-ip",
                                    "ref": "GCP Docs"
                                }
                            ]
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.6.2",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{control_id}-#{control_abbrev}\" do\n    impact 'low'\n\n    title \"[#{control_abbrev.upcase}] Enable VPC Flow Logs and Intranode Visibility\"\n\n    desc \"Enable VPC Flow Logs and Intranode Visibility to see pod-level traffic, even for traffic\n    within a worker node.\"\n    desc 'rationale', \"Enabling Intranode Visibility makes your intranode pod to pod traffic visible to the\n    networking fabric. With this feature, you can use VPC Flow Logs or other VPC features for\n    intranode traffic.\"\n\n    tag cis_scored: true\n    tag cis_level: 2\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/intranode-visibility'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('network_config.enable_intra_node_visibility') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 38,
                        "ref": "inspec-gke-cis-gcp/controls/5.06-networking.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 ip_allocation_policy.use_ip_aliases is expected to cmp == true",
                            "run_time": 0.234997898,
                            "start_time": "2023-04-28T16:23:27+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "ip_allocation_policy.use_ip_aliases"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.6.3-networking",
                    "title": "[NETWORKING] Ensure Master Authorized Networks is Enabled",
                    "desc": "Enable Master Authorized Networks to restrict access to the cluster's control plane (master endpoint) to only an allowlist of authorized IPs.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Enable Master Authorized Networks to restrict access to the cluster's control plane (master endpoint) to only an allowlist of authorized IPs."
                        },
                        {
                            "label": "rationale",
                            "data": "Authorized networks are a way of specifying a restricted range of IP addresses that are permitted to access your cluster's control plane. Kubernetes Engine uses both Transport Layer Security (TLS) and authentication to provide secure access to your cluster's control plane from the public internet. This provides you the flexibility to administer your cluster from anywhere; however, you might want to further restrict access to a set of IP addresses that you control. You can set this restriction by specifying an authorized network.\n\n  Master Authorized Networks blocks untrusted IP addresses. Google Cloud Platform IPs (such as traffic from Compute Engine VMs) can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.\n\n  Restricting access to an authorized network can provide additional security benefits for your container cluster, including:\n\n  - Better protection from outsider attacks: Authorized networks provide an additional layer of security by limiting external, non-GCP access to a specific set of addresses you designate, such as those that originate from your premises. This helps protect access to your cluster in the case of a vulnerability in the cluster's authentication or authorization mechanism.\n\n  - Better protection from insider attacks: Authorized networks help protect your cluster from accidental leaks of master certificates from your company's premises. Leaked certificates used from outside GCP and outside the authorized IP ranges (for example, from addresses outside your company) are still denied access."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.6.3",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Master Authorized Networks is Enabled\"\n\n    desc \"Enable Master Authorized Networks to restrict access to the cluster's control plane (master endpoint) to only an allowlist of authorized IPs.\"\n    desc 'rationale', \"Authorized networks are a way of specifying a restricted range of IP addresses that are permitted to access your cluster's control plane. Kubernetes Engine uses both Transport Layer Security (TLS) and authentication to provide secure access to your cluster's control plane from the public internet. This provides you the flexibility to administer your cluster from anywhere; however, you might want to further restrict access to a set of IP addresses that you control. You can set this restriction by specifying an authorized network.\n\n  Master Authorized Networks blocks untrusted IP addresses. Google Cloud Platform IPs (such as traffic from Compute Engine VMs) can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.\n\n  Restricting access to an authorized network can provide additional security benefits for your container cluster, including:\n\n  - Better protection from outsider attacks: Authorized networks provide an additional layer of security by limiting external, non-GCP access to a specific set of addresses you designate, such as those that originate from your premises. This helps protect access to your cluster in the case of a vulnerability in the cluster's authentication or authorization mechanism.\n\n  - Better protection from insider attacks: Authorized networks help protect your cluster from accidental leaks of master certificates from your company's premises. Leaked certificates used from outside GCP and outside the authorized IP ranges (for example, from addresses outside your company) are still denied access.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('master_authorized_networks_config.cidr_blocks') { should_not be_empty }\n        its('master_authorized_networks_config.cidr_blocks.to_s') { should_not match %r{0.0.0.0/0} }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 101,
                        "ref": "inspec-gke-cis-gcp/controls/5.06-networking.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 master_authorized_networks_config.cidr_blocks is expected not to be empty",
                            "run_time": 0.261493071,
                            "start_time": "2023-04-28T16:23:28+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "master_authorized_networks_config.cidr_blocks"
                        },
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 master_authorized_networks_config.cidr_blocks.to_s is expected not to match /0.0.0.0\\/0/",
                            "run_time": 0.24507222,
                            "start_time": "2023-04-28T16:23:28+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "master_authorized_networks_config.cidr_blocks.to_s"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.6.4-networking",
                    "title": "[NETWORKING] Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled",
                    "desc": "Disable access to the Kubernetes API from outside the node network if it is not required.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Disable access to the Kubernetes API from outside the node network if it is not required."
                        },
                        {
                            "label": "rationale",
                            "data": "Tigera Response: Not applicable, public access to Kubernetes API is required.\n Default: In a private cluster, the master node has two endpoints, a private and public endpoint. The private endpoint is the internal IP address of the master, behind an internal load balancer in the master's VPC network. Nodes communicate with the master using the private endpoint. The public endpoint enables the Kubernetes API to be accessed from outside the master's VPC network.\n\n  Although Kubernetes API requires an authorized token to perform sensitive actions, a vulnerability could potentially expose the Kubernetes publically with unrestricted access. Additionally, an attacker may be able to identify the current cluster and Kubernetes API version and determine whether it is vulnerable to an attack. Unless required, disabling public endpoint will help prevent such threats, and require the attacker to be on the master's VPC network to perform any attack on the Kubernetes API."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 2,
                        "cis_gke": "5.6.4",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled\"\n\n    desc 'Disable access to the Kubernetes API from outside the node network if it is not required.'\n    desc 'rationale', \"In a private cluster, the master node has two endpoints, a private and public endpoint. The private endpoint is the internal IP address of the master, behind an internal load balancer in the master's VPC network. Nodes communicate with the master using the private endpoint. The public endpoint enables the Kubernetes API to be accessed from outside the master's VPC network.\n\n  Although Kubernetes API requires an authorized token to perform sensitive actions, a vulnerability could potentially expose the Kubernetes publically with unrestricted access. Additionally, an attacker may be able to identify the current cluster and Kubernetes API version and determine whether it is vulnerable to an attack. Unless required, disabling public endpoint will help prevent such threats, and require the attacker to be on the master's VPC network to perform any attack on the Kubernetes API.\"\n\n    tag cis_scored: true\n    tag cis_level: 2\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('private_cluster_config.enable_private_endpoint') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 137,
                        "ref": "inspec-gke-cis-gcp/controls/5.06-networking.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 private_cluster_config.enable_private_endpoint is expected to cmp == true",
                            "run_time": 0.24088723,
                            "start_time": "2023-04-28T16:23:29+00:00",
                            "message": "\nexpected: true\n     got: \n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "private_cluster_config.enable_private_endpoint"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.6.5-networking",
                    "title": "[NETWORKING] Ensure clusters are created with Private Nodes",
                    "desc": "Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses."
                        },
                        {
                            "label": "rationale",
                            "data": "Disabling public IP addresses on cluster nodes restricts access to only internal networks, forcing attackers to obtain local network access before attempting to compromise the underlying Kubernetes hosts."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.6.5",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure clusters are created with Private Nodes\"\n\n    desc 'Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses.'\n    desc 'rationale', 'Disabling public IP addresses on cluster nodes restricts access to only internal networks, forcing attackers to obtain local network access before attempting to compromise the underlying Kubernetes hosts.'\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('private_cluster_config.enable_private_nodes') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 166,
                        "ref": "inspec-gke-cis-gcp/controls/5.06-networking.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 private_cluster_config.enable_private_nodes is expected to cmp == true",
                            "run_time": 0.260412271,
                            "start_time": "2023-04-28T16:23:29+00:00",
                            "message": "\nexpected: true\n     got: \n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "private_cluster_config.enable_private_nodes"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.6.7-networking",
                    "title": "[NETWORKING] Ensure Network policy is enabled on Kubernetes Engine Clusters",
                    "desc": "A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other."
                        },
                        {
                            "label": "rationale",
                            "data": "By default, pods are non-isolated; they accept traffic from any source. Pods become isolated by having a NetworkPolicy that selects them. Once there is any NetworkPolicy in a namespace selecting a particular pod, that pod will reject any connections that are not allowed by any NetworkPolicy. (Other pods in the namespace that are not selected by any NetworkPolicy will continue to accept all traffic.)"
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://kubernetes.io/docs/concepts/services-networking/network-policies/#the-networkpolicy-resource",
                            "ref": "GCP Docs"
                        },
                        {
                            "url": "https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.10/#networkpolicy-v1-networking",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.6.7",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Network policy is enabled on Kubernetes Engine Clusters\"\n\n    desc 'A network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. NetworkPolicy resources use labels to select pods and define rules which specify what traffic is allowed to the selected pods. The Kubernetes Network Policy API allows the cluster administrator to specify what pods are allowed to communicate with each other.'\n    desc 'rationale', 'By default, pods are non-isolated; they accept traffic from any source. Pods become isolated by having a NetworkPolicy that selects them. Once there is any NetworkPolicy in a namespace selecting a particular pod, that pod will reject any connections that are not allowed by any NetworkPolicy. (Other pods in the namespace that are not selected by any NetworkPolicy will continue to accept all traffic.)'\n\n    tag cis_scored: false\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://kubernetes.io/docs/concepts/services-networking/network-policies/#the-networkpolicy-resource'\n    ref 'GCP Docs', url: 'https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.10/#networkpolicy-v1-networking'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('network_policy.enabled') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 193,
                        "ref": "inspec-gke-cis-gcp/controls/5.06-networking.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 network_policy.enabled is expected to cmp == true",
                            "run_time": 0.234060339,
                            "start_time": "2023-04-28T16:23:30+00:00",
                            "message": "\nexpected: true\n     got: \n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "network_policy.enabled"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.7.1-logging",
                    "title": "[LOGGING] Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled",
                    "desc": "Send logs and metrics to a remote aggregator to mitigate the risk of local tampering in the event of a breach.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Send logs and metrics to a remote aggregator to mitigate the risk of local tampering in the event of a breach."
                        },
                        {
                            "label": "rationale",
                            "data": "Exporting logs and metrics to a dedicated, persistent datastore such as Stackdriver ensures availability of audit data following a cluster security event, and provides a central location for analysis of log and metric data collated from multiple sources.\n\n  Currently, there are two mutually exclusive variants of Stackdriver available for use with GKE clusters: Legacy Stackdriver Support and Stackdriver Kubernetes Engine Monitoring Support.\n\n  Although Stackdriver Kubernetes Engine Monitoring is the preferred option, starting with GKE versions 1.12.7 and 1.13, Legacy Stackdriver is the default option up through GKE version 1.13. The use of either of these services is sufficient to pass the benchmark recommendation.\n\n  However, note that as Legacy Stackdriver Support is not getting any improvements and lacks features present in Stackdriver Kubernetes Engine Monitoring, Legacy Stackdriver Support may be deprecated in favour of Stackdriver Kubernetes Engine Monitoring Support in future versions of this benchmark."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-container-cluster",
                            "ref": "GCP Docs"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/logging",
                            "ref": "GCP Docs"
                        },
                        {
                            "url": "https://cloud.google.com/logging/docs/basic-concepts",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.7.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{control_id}-#{control_abbrev}\" do\n    impact 'low'\n\n    title \"[#{control_abbrev.upcase}] Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled\"\n\n    desc 'Send logs and metrics to a remote aggregator to mitigate the risk of local tampering in the event of a breach.'\n    desc 'rationale', \"Exporting logs and metrics to a dedicated, persistent datastore such as Stackdriver ensures availability of audit data following a cluster security event, and provides a central location for analysis of log and metric data collated from multiple sources.\n\n  Currently, there are two mutually exclusive variants of Stackdriver available for use with GKE clusters: Legacy Stackdriver Support and Stackdriver Kubernetes Engine Monitoring Support.\n\n  Although Stackdriver Kubernetes Engine Monitoring is the preferred option, starting with GKE versions 1.12.7 and 1.13, Legacy Stackdriver is the default option up through GKE version 1.13. The use of either of these services is sufficient to pass the benchmark recommendation.\n\n  However, note that as Legacy Stackdriver Support is not getting any improvements and lacks features present in Stackdriver Kubernetes Engine Monitoring, Legacy Stackdriver Support may be deprecated in favour of Stackdriver Kubernetes Engine Monitoring Support in future versions of this benchmark.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-container-cluster'\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/logging'\n    ref 'GCP Docs', url: 'https://cloud.google.com/logging/docs/basic-concepts'\n\n    # if gke_clusters.members.nil? || gke_clusters.members.count.zero?\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('logging_service') { should match(/^logging.googleapis.com/) }\n        its('monitoring_service') { should match(/^monitoring.googleapis.com/) }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 37,
                        "ref": "inspec-gke-cis-gcp/controls/5.07-logging.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 logging_service is expected to match /^logging.googleapis.com/",
                            "run_time": 0.263813575,
                            "start_time": "2023-04-28T16:23:24+00:00",
                            "message": "expected \"none\" to match /^logging.googleapis.com/\nDiff:\n@@ -1 +1 @@\n-/^logging.googleapis.com/\n+\"none\"\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "logging_service"
                        },
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 monitoring_service is expected to match /^monitoring.googleapis.com/",
                            "run_time": 2.741908215,
                            "start_time": "2023-04-28T16:23:24+00:00",
                            "message": "expected \"none\" to match /^monitoring.googleapis.com/\nDiff:\n@@ -1 +1 @@\n-/^monitoring.googleapis.com/\n+\"none\"\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "monitoring_service"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.8.1-authn-authz",
                    "title": "[AUTHN-AUTHZ] Ensure Basic Authentication using static passwords is Disabled",
                    "desc": "Disable Basic Authentication (basic auth) for API server authentication as it uses static passwords which need to be rotated.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Disable Basic Authentication (basic auth) for API server authentication as it uses static passwords which need to be rotated."
                        },
                        {
                            "label": "rationale",
                            "data": "Basic Authentication allows a user to authenticate to a Kubernetes cluster with a username and static password which is stored in plaintext (without any encryption). Disabling Basic Authentication will prevent attacks like brute force and credential stuffing. It is recommended to disable Basic Authentication and instead use another authentication method such as OpenID Connect.\n\n  GKE manages authentication via gcloud using the OpenID Connect token method, setting up the Kubernetes configuration, getting an access token, and keeping it up to date. This means Basic Authentication using static passwords and Client Certificate authentication, which both require additional management overhead of key management and rotation, are not necessary and should be disabled.\n\n  When Basic Authentication is disabled, you will still be able to authenticate to the cluster with other authentication methods, such as OpenID Connect tokens. See also Recommendation 5.8.2 to disable authentication using Client Certificates."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/iam-integration",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.8.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Basic Authentication using static passwords is Disabled\"\n\n    desc 'Disable Basic Authentication (basic auth) for API server authentication as it uses static passwords which need to be rotated.'\n    desc 'rationale', \"Basic Authentication allows a user to authenticate to a Kubernetes cluster with a username and static password which is stored in plaintext (without any encryption). Disabling Basic Authentication will prevent attacks like brute force and credential stuffing. It is recommended to disable Basic Authentication and instead use another authentication method such as OpenID Connect.\n\n  GKE manages authentication via gcloud using the OpenID Connect token method, setting up the Kubernetes configuration, getting an access token, and keeping it up to date. This means Basic Authentication using static passwords and Client Certificate authentication, which both require additional management overhead of key management and rotation, are not necessary and should be disabled.\n\n  When Basic Authentication is disabled, you will still be able to authenticate to the cluster with other authentication methods, such as OpenID Connect tokens. See also Recommendation 5.8.2 to disable authentication using Client Certificates.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/iam-integration'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('master_auth.username') { should cmp nil }\n        # master_auth.password should also be nil, but we don't want to put that sensitive info in the output\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 38,
                        "ref": "inspec-gke-cis-gcp/controls/5.08-authn-authz.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 master_auth.username is expected to cmp == nil",
                            "run_time": 0.252658398,
                            "start_time": "2023-04-28T16:23:30+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "master_auth.username"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.8.2-authn-authz",
                    "title": "[AUTHN-AUTHZ] Ensure authentication using Client Certificates is Disabled",
                    "desc": "Disable Client Certificates, which require certificate rotation, for authentication. Instead, use another authentication method like OpenID Connect.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Disable Client Certificates, which require certificate rotation, for authentication. Instead, use another authentication method like OpenID Connect."
                        },
                        {
                            "label": "rationale",
                            "data": "With Client Certificate authentication, a client presents a certificate that the API server verifies with the specified Certificate Authority. In GKE, Client Certificates are signed by the cluster root Certificate Authority. When retrieved, the Client Certificate is only base64 encoded and not encrypted.\n\n  GKE manages authentication via gcloud for you using the OpenID Connect token method, setting up the Kubernetes configuration, getting an access token, and keeping it up to date. This means Basic Authentication using static passwords and Client Certificate authentication, which both require additional management overhead of key management and rotation, are not necessary and should be disabled.\n\n  When Client Certificate authentication is disabled, you will still be able to authenticate to the cluster with other authentication methods, such as OpenID Connect tokens. See also Recommendation 6.8.1 to disable authentication using static passwords, known as Basic Authentication."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your- cluster#restrict_authn_methods",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.8.2",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure authentication using Client Certificates is Disabled\"\n\n    desc 'Disable Client Certificates, which require certificate rotation, for authentication. Instead, use another authentication method like OpenID Connect.'\n    desc 'rationale', \"With Client Certificate authentication, a client presents a certificate that the API server verifies with the specified Certificate Authority. In GKE, Client Certificates are signed by the cluster root Certificate Authority. When retrieved, the Client Certificate is only base64 encoded and not encrypted.\n\n  GKE manages authentication via gcloud for you using the OpenID Connect token method, setting up the Kubernetes configuration, getting an access token, and keeping it up to date. This means Basic Authentication using static passwords and Client Certificate authentication, which both require additional management overhead of key management and rotation, are not necessary and should be disabled.\n\n  When Client Certificate authentication is disabled, you will still be able to authenticate to the cluster with other authentication methods, such as OpenID Connect tokens. See also Recommendation 6.8.1 to disable authentication using static passwords, known as Basic Authentication.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your- cluster#restrict_authn_methods'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\", :sensitive do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('master_auth.client_certificate') { should cmp nil }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 70,
                        "ref": "inspec-gke-cis-gcp/controls/5.08-authn-authz.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 master_auth.client_certificate is expected to cmp == nil",
                            "run_time": 0.235010845,
                            "start_time": "2023-04-28T16:23:31+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "master_auth.client_certificate"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.8.4-authn-authz",
                    "title": "[AUTHN-AUTHZ] Ensure Legacy Authorization (ABAC) is Disabled",
                    "desc": "Legacy Authorization, also known as Attribute-Based Access Control (ABAC) has been superseded by Role-Based Access Control (RBAC) and is not under active development. RBAC is the recommended way to manage permissions in Kubernetes.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Legacy Authorization, also known as Attribute-Based Access Control (ABAC) has been superseded by Role-Based Access Control (RBAC) and is not under active development. RBAC is the recommended way to manage permissions in Kubernetes."
                        },
                        {
                            "label": "rationale",
                            "data": "In Kubernetes, RBAC is used to grant permissions to resources at the cluster and namespace level. RBAC allows you to define roles with rules containing a set of permissions, whilst the legacy authorizer (ABAC) in Kubernetes Engine grants broad, statically defined permissions. As RBAC provides significant security advantages over ABAC, it is recommended option for access control. Where possible, legacy authorization must be disabled for GKE clusters."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control",
                            "ref": "GCP Docs"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your- cluster#leave_abac_disabled_default_for_110",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.8.4",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Legacy Authorization (ABAC) is Disabled\"\n\n    desc 'Legacy Authorization, also known as Attribute-Based Access Control (ABAC) has been superseded by Role-Based Access Control (RBAC) and is not under active development. RBAC is the recommended way to manage permissions in Kubernetes.'\n    desc 'rationale', 'In Kubernetes, RBAC is used to grant permissions to resources at the cluster and namespace level. RBAC allows you to define roles with rules containing a set of permissions, whilst the legacy authorizer (ABAC) in Kubernetes Engine grants broad, statically defined permissions. As RBAC provides significant security advantages over ABAC, it is recommended option for access control. Where possible, legacy authorization must be disabled for GKE clusters.'\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control'\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your- cluster#leave_abac_disabled_default_for_110'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('legacy_abac.enabled') { should cmp nil }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 101,
                        "ref": "inspec-gke-cis-gcp/controls/5.08-authn-authz.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 legacy_abac.enabled is expected to cmp == nil",
                            "run_time": 0.09130661,
                            "start_time": "2023-04-28T16:23:31+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "legacy_abac.enabled"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.10.1-other",
                    "title": "[OTHER] Ensure Kubernetes Web UI is Disabled",
                    "desc": "The Kubernetes Web UI (Dashboard) has been a historical source of vulnerability and should only be deployed when necessary.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "The Kubernetes Web UI (Dashboard) has been a historical source of vulnerability and should only be deployed when necessary."
                        },
                        {
                            "label": "rationale",
                            "data": "You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI is backed by a highly privileged Kubernetes Service Account.\n\n  The Google Cloud Console provides all the required functionality of the Kubernetes Web UI and leverages Cloud IAM to restrict user access to sensitive cluster controls and settings."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#disable_kubernetes_dashboard",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.10.1",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Kubernetes Web UI is Disabled\"\n\n    desc 'The Kubernetes Web UI (Dashboard) has been a historical source of vulnerability and should only be deployed when necessary.'\n    desc 'rationale', \"You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI is backed by a highly privileged Kubernetes Service Account.\n\n  The Google Cloud Console provides all the required functionality of the Kubernetes Web UI and leverages Cloud IAM to restrict user access to sensitive cluster controls and settings.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#disable_kubernetes_dashboard'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        # TODO: Inspec-GCP support needed\n        its('addons_config.kubernetes_dashboard.disabled') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 38,
                        "ref": "inspec-gke-cis-gcp/controls/5.10-other.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 addons_config.kubernetes_dashboard.disabled is expected to cmp == true",
                            "run_time": 0.256795068,
                            "start_time": "2023-04-28T16:23:22+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "addons_config.kubernetes_dashboard.disabled"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.10.2-other",
                    "title": "[OTHER] Ensure that Alpha clusters are not used for production workloads",
                    "desc": "Alpha clusters are not covered by an SLA and are not production-ready.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Alpha clusters are not covered by an SLA and are not production-ready."
                        },
                        {
                            "label": "rationale",
                            "data": "Alpha clusters are designed for early adopters to experiment with workloads that take\n    advantage of new features before those features are production-ready. They have all\n    Kubernetes API features enabled, but are not covered by the GKE SLA, do not receive\n    security updates, have node auto-upgrade and node auto-repair disabled, and cannot be\n    upgraded. They are also automatically deleted after 30 days."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/alpha-clusters",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 1,
                        "cis_gke": "5.10.2",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure that Alpha clusters are not used for production workloads\"\n\n    desc 'Alpha clusters are not covered by an SLA and are not production-ready.'\n    desc 'rationale', \"Alpha clusters are designed for early adopters to experiment with workloads that take\n    advantage of new features before those features are production-ready. They have all\n    Kubernetes API features enabled, but are not covered by the GKE SLA, do not receive\n    security updates, have node auto-upgrade and node auto-repair disabled, and cannot be\n    upgraded. They are also automatically deleted after 30 days.\"\n\n    tag cis_scored: true\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/concepts/alpha-clusters'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('enable_kubernetes_alpha') { should eq nil }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 68,
                        "ref": "inspec-gke-cis-gcp/controls/5.10-other.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 enable_kubernetes_alpha is expected to eq nil",
                            "run_time": 0.260538258,
                            "start_time": "2023-04-28T16:23:22+00:00",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "enable_kubernetes_alpha"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.10.3-other",
                    "title": "[OTHER] Ensure Pod Security Policy is Enabled and set as appropriate",
                    "desc": "Pod Security Policy should be used to prevent privileged containers where possible and enforce namespace and workload configurations.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Pod Security Policy should be used to prevent privileged containers where possible and enforce namespace and workload configurations."
                        },
                        {
                            "label": "rationale",
                            "data": "Tigera Response: Not applicable, PSP is depreciated in Kubernetes v1.25 which we will upgrade to in Q2.\n Default: A Pod Security Policy is a cluster-level resource that controls security sensitive aspects of the pod specification. A PodSecurityPolicy object defines a set of conditions that a pod must run with in order to be accepted into the system, as well as defaults for the related fields. When a request to create or update a Pod does not meet the conditions in the Pod Security Policy, that request is rejected and an error is returned. The Pod Security Policy admission controller validates requests against available Pod Security Policies.\n\n  PodSecurityPolicies specify a list of restrictions, requirements, and defaults for Pods created under the policy. See further details on recommended policies in Recommendation section 5.2."
                        }
                    ],
                    "impact": 0.0,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/pod-security-policies",
                            "ref": "GCP Docs"
                        },
                        {
                            "url": "https://kubernetes.io/docs/concepts/policy/pod-security-policy",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": false,
                        "cis_level": 1,
                        "cis_gke": "5.10.3",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure Pod Security Policy is Enabled and set as appropriate\"\n\n    desc 'Pod Security Policy should be used to prevent privileged containers where possible and enforce namespace and workload configurations.'\n    desc 'rationale', \"A Pod Security Policy is a cluster-level resource that controls security sensitive aspects of the pod specification. A PodSecurityPolicy object defines a set of conditions that a pod must run with in order to be accepted into the system, as well as defaults for the related fields. When a request to create or update a Pod does not meet the conditions in the Pod Security Policy, that request is rejected and an error is returned. The Pod Security Policy admission controller validates requests against available Pod Security Policies.\n\n  PodSecurityPolicies specify a list of restrictions, requirements, and defaults for Pods created under the policy. See further details on recommended policies in Recommendation section 5.2.\"\n\n    tag cis_scored: false\n    tag cis_level: 1\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/kubernetes-engine/docs/how-to/pod-security-policies'\n    ref 'GCP Docs', url: 'https://kubernetes.io/docs/concepts/policy/pod-security-policy'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name], beta: true) }\n        # TODO: Inspec-GCP support\n        its('pod_security_policy_config.enabled') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 99,
                        "ref": "inspec-gke-cis-gcp/controls/5.10-other.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "failed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 pod_security_policy_config.enabled is expected to cmp == true",
                            "run_time": 0.24833458,
                            "start_time": "2023-04-28T16:23:23+00:00",
                            "message": "\nexpected: true\n     got: \n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "pod_security_policy_config.enabled"
                        }
                    ]
                },
                {
                    "id": "cis-gke-5.10.5-other",
                    "title": "[OTHER] Ensure use of Binary Authorization",
                    "desc": "Binary Authorization helps to protect supply-chain security by only allowing images with verifiable cryptographically signed metadata into the cluster.",
                    "descriptions": [
                        {
                            "label": "default",
                            "data": "Binary Authorization helps to protect supply-chain security by only allowing images with verifiable cryptographically signed metadata into the cluster."
                        },
                        {
                            "label": "rationale",
                            "data": "Binary Authorization provides software supply-chain security for images that you deploy to GKE from Google Container Registry (GCR) or another container image registry.\n    Binary Authorization requires images to be signed by trusted authorities during the development process. These signatures are then validated at deployment time. By\n    enforcing validation, you can gain tighter control over your container environment by ensuring only verified images are integrated into the build-and-release process."
                        }
                    ],
                    "impact": 0.4,
                    "refs": [
                        {
                            "url": "https://www.cisecurity.org/benchmark/kubernetes/",
                            "ref": "CIS Benchmark"
                        },
                        {
                            "url": "https://cloud.google.com/binary-authorization/",
                            "ref": "GCP Docs"
                        }
                    ],
                    "tags": {
                        "cis_scored": true,
                        "cis_level": 2,
                        "cis_gke": "5.10.5",
                        "cis_version": "1.1",
                        "project": "tigera-tesla"
                    },
                    "code": "  control \"cis-gke-#{sub_control_id}-#{control_abbrev}\" do\n    impact 'medium'\n\n    title \"[#{control_abbrev.upcase}] Ensure use of Binary Authorization\"\n\n    desc 'Binary Authorization helps to protect supply-chain security by only allowing images with verifiable cryptographically signed metadata into the cluster.'\n    desc 'rationale', \"Binary Authorization provides software supply-chain security for images that you deploy to GKE from Google Container Registry (GCR) or another container image registry.\n    Binary Authorization requires images to be signed by trusted authorities during the development process. These signatures are then validated at deployment time. By\n    enforcing validation, you can gain tighter control over your container environment by ensuring only verified images are integrated into the build-and-release process.\"\n\n    tag cis_scored: true\n    tag cis_level: 2\n    tag cis_gke: sub_control_id.to_s\n    tag cis_version: cis_version.to_s\n    tag project: gcp_project_id.to_s\n\n    ref 'CIS Benchmark', url: cis_url.to_s\n    ref 'GCP Docs', url: 'https://cloud.google.com/binary-authorization/'\n\n    gke_clusters.each do |gke_cluster|\n      describe \"[#{gcp_project_id}] Cluster #{gke_cluster[:location]}/#{gke_cluster[:cluster_name]}\" do\n        subject { google_container_cluster(project: gcp_project_id, location: gke_cluster[:location], name: gke_cluster[:cluster_name]) }\n        its('binary_authorization.enabled') { should cmp true }\n      end\n    end\n  end\n",
                    "source_location": {
                        "line": 129,
                        "ref": "inspec-gke-cis-gcp/controls/5.10-other.rb"
                    },
                    "waiver_data": {},
                    "results": [
                        {
                            "status": "passed",
                            "code_desc": "[tigera-tesla] Cluster us-central1/ops-01 binary_authorization.enabled is expected to cmp == true",
                            "run_time": 0.245453861,
                            "start_time": "2023-04-28T16:23:23+00:00",
                            "message": "\nexpected: true\n     got: true\n\n(compared using `cmp` matcher)\n",
                            "resource_class": "Object",
                            "resource_params": "[]",
                            "resource_id": "binary_authorization.enabled"
                        }
                    ]
                }
            ],
            "status": "loaded",
            "status_message": ""
        },
        {
            "name": "inspec-gcp-helpers",
            "version": "1.0.9",
            "sha256": "b1c6f2c7ed6422ad89f949c7eb6eed3bd642b350ae0d7bda4f44ff2a3c182177",
            "title": "GCP CIS PCI Helper Resource Pack",
            "summary": "This resource pack provides helpers for the Google Cloud Platform Inspec profiles.",
            "license": "Apache-2.0",
            "copyright": "Google",
            "copyright_email": "copyright@google.com",
            "supports": [
                {
                    "platform": "gcp"
                }
            ],
            "attributes": [
                {
                    "name": "gcp_project_id",
                    "options": {
                        "value": "tigera-tesla"
                    }
                },
                {
                    "name": "gcp_gke_locations",
                    "options": {
                        "value": [
                            "us-central1"
                        ]
                    }
                },
                {
                    "name": "gce_zones",
                    "options": {
                        "value": [
                            "us-central1"
                        ]
                    }
                }
            ],
            "parent_profile": "inspec-gke-cis-gcp",
            "depends": [
                {
                    "name": "inspec-gcp",
                    "url": "https://github.com/inspec/inspec-gcp/archive/v1.8.1.tar.gz",
                    "status": "loaded"
                }
            ],
            "groups": [],
            "controls": [],
            "status": "loaded",
            "status_message": ""
        },
        {
            "name": "inspec-gcp",
            "version": "1.8.1",
            "sha256": "0a81e12583941bde8b83ef43f94f4c0b54a036b1a9306cebedb92ede0c928f91",
            "title": "Google Cloud Platform Resource Pack",
            "maintainer": "spaterson@chef.io,russell.seymour@turtlesystems.co.uk",
            "summary": "This resource pack provides compliance resources_old_ignore for Google Cloud Platform",
            "license": "Apache-2.0",
            "copyright": "spaterson@chef.io,russell.seymour@turtlesystems.co.uk",
            "copyright_email": "spaterson@chef.io,russell.seymour@turtlesystems.co.uk",
            "supports": [
                {
                    "platform": "gcp"
                }
            ],
            "attributes": [
                {
                    "name": "gcp_project_id",
                    "options": {
                        "value": "tigera-tesla"
                    }
                },
                {
                    "name": "gcp_gke_locations",
                    "options": {
                        "value": [
                            "us-central1"
                        ]
                    }
                },
                {
                    "name": "gce_zones",
                    "options": {
                        "value": [
                            "us-central1"
                        ]
                    }
                }
            ],
            "parent_profile": "inspec-gcp-helpers",
            "groups": [],
            "controls": [],
            "status": "loaded",
            "status_message": ""
        }
    ],
    "statistics": {
        "duration": 20.311706443
    },
    "version": "5.18.14"
}
